```{r}
#| include: false
#| label: module-2-first-chunk
```

## Installing R {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
Installing R is very simple.

You just need to download the installer from the [**Comprehensive R Archive Network**](https://cran.r-project.org/) (CRAN).

Go to *Download R for \[YOUR OS\]* and then click on the *base* link (the base version  of R).

Simply follow the instructions of the installer.
:::
::: {.column style="width: 50%;"}
[![](images/cran-logo.png){fig-align="center" style="width: 60%; padding-top: 80px;"}](https://cran.r-project.org/)
:::
::::

::: {.notes}
:::

## Installing R {.smaller}

```{=html}
<video width="100%" style="display: block; margin: 0 auto;" muted controls>
  <source src="images/installing-r.mp4" type="video/mp4">
</video>
```

::: {.notes}
:::

## The Positron IDE {.smaller .nostretch}

An IDE (Integrated Development Environment) is a software that provides a set of tools to help the programmer to write code. It puts together things like a text editor, a console, a debugger, and a file manager.

[![](images/positron-logo.png){fig-align="center" style="width: 60%; padding-top: 25px;"}](https://positron.posit.co/)

[Positron](https://positron.posit.co/) is *flavour* of [Visual Studio Code](https://code.visualstudio.com/), the most used IDE for programming in any language. It supersedes [RStudio](https://posit.co/download/rstudio-desktop/), the main IDE for R for many years, focusing in providing a better experience for programming in R and Python.

::: {style="padding-top: 15px;"}
**Note**: Always use technical softwares in English.
:::

::: {.notes}
:::

## The Positron IDE

![](images/positron-interface.jpeg){.r-stretch fig-align="center"}

::: footer
(Reproduced from [Posit](https://positron.posit.co/layout.html))
:::

## Installing Positron {.smaller}

```{=html}
<video width="100%" style="display: block; margin: 0 auto;" muted controls>
  <source src="images/installing-positron.mp4" type="video/mp4">
</video>
```

::: {.notes}
:::

## Creating a Project {.smaller}

:::: {.columns}
::: {.column style="width: 50%; font-size: 0.9em"}
[Project-oriented workflow](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/).

A project consolidates all related files and resources in one place, ensuring that your work is reproducible and well-organized.

It is important to have a structured project directory. A best practice is to follow the structure made for **R Packages** [@marwick2018].

Every data project must be accompanied, at least, by a **README** file, explaining the project, and a **LICENSE** file, defining the terms of use of the data (See Open Source Licenses [here](https://choosealicense.com/licenses/)).
:::
::: {.column style="width: 50%;"}
![](images/marwick-2018-figure-2.png){fig-align="center" style="width: 80%; padding-top: 25px;"}
:::
::::

::: footer
(Reproduced from @marwick2018)
:::

::: {.notes}
- Ask for students to create a project folder names `r-course` in their pen drive or computer.
- Open the `r-course` folder in Positron.
- Use `library(usethis)` and `usethis::create_project(".")` to create projects in R.
:::

## Creating a Project {.smaller}

```{=html}
<video width="100%" style="display: block; margin: 0 auto;" muted controls>
  <source src="images/creating-a-project.mp4" type="video/mp4">
</video>
```

::: {.notes}
- Ask for students to create a project folder names `r-course` in their pen drive or computer.
- Open the `r-course` folder in Positron.
- Use `library(usethis)` and `usethis::create_project(".")` to create projects in R.
:::

## Add. a README & LICENSE File {.smaller}

::::: {.columns}
:::: {.column style="width: 50%;"}
You can use the [`usethis`](https://usethis.r-lib.org/) R package to create these files.

::: {style="padding-top: 15px;"}
First, call the package using:

```r
# install.packages("usethis")
library(usethis)
```

Add a README file using:

```r
use_readme_md()
```

Add a [GNU General Public License version 3](https://www.gnu.org/licenses/gpl-3.0) file using:

```r
use_gpl3_license()
```
:::
::::
:::: {.column style="width: 50%;"}
[![](images/gplv3-license-logo.svg){fig-align="center" style="width: 75%; padding-top: 150px;"}](https://www.gnu.org/licenses/gpl-3.0)
::::
:::::

::: {.notes}
- Use `use_readme_md()` to create a README file.
- Add "My R Course files." in the README file.
- Use `use_gpl3_license()` to create a LICENSE file.
- Briefly explain about open licenses and the GNU GPLv3 license.
:::

## Add. a README & LICENSE File {.smaller}

```{=html}
<video width="100%" style="display: block; margin: 0 auto;" muted controls>
  <source src="images/adding-a-readme.mp4" type="video/mp4">
</video>
```

::: {.notes}
:::

## Quarto Notebooks {.smaller}

[![](images/allison-horst-figure-49.png){fig-align="center" style="width: 100%; padding-top: 75px;"}](https://quarto.org/)

::: footer
(Artwork by [Allison Horst](https://allisonhorst.com/horst-hill-collaborations))
:::

::: {.notes}
- Mention that this presentation was made using Quarto.
- There are more examples of Quarto renderings at the end of the course material.
:::

## Markdown Basics {.smaller}

:::: {.columns}
::: {.column style="width: 50%; font-size: 0.95em;"}
[Markdown](https://www.markdownguide.org) is a lightweight **markup language** with plain text formatting syntax. The great thing about Markdown is that you can forget about the formatting and focus on the content.

Quarto Notebooks are a type of Markdown document that allows you to mix code, text, and output in a single document. These slides are all written in Markdown.

Learn more about the Markdown syntax [here](https://www.markdownguide.org/basic-syntax/).
:::
::: {.column style="width: 50%;"}
[![](images/markdown-logo.svg){fig-align="center" style="width: 70%; padding-top: 125px;"}](https://www.markdownguide.org)
:::
::::

::: {.notes}
:::

## Creating a Quarto Notebook {.smaller}

```{=html}
<video width="100%" style="display: block; margin: 0 auto;" muted controls>
  <source src="images/creating-a-quarto-notebook.mp4" type="video/mp4">
</video>
```

::: {.notes}
- In Positron, go to *File* > *New File* > *Quarto Document...*.
- Show how they can organize the code using headings.
:::

## Objects {.smaller}

::::: {.columns}
:::: {.column style="width: 50%;"}
**Everything in R is an [object](https://en.wikipedia.org/wiki/Object_(computer_science))**.

Everything that happens in R is the result of a [function](https://en.wikipedia.org/wiki/Function_(computer_programming)) call.

::: {style="padding-top: 15px;"}
**Scalars** (0D): `1`

**Vectors** (1D): `c(1, 2, 3)`

**Matrices** (2D):<br>`matrix(1:9, nrow = 3, ncol = 3)`

**Arrays** (nD):<br>`array(1:27, dim = c(3, 3, 3))`
:::
::::
:::: {.column style="width: 50%; padding-top: 0px;"}
![](images/srivastava-2019-figure-1-adapted-rgb-72-dpi.png){fig-align="center" style="width: 85%;"}
::::
:::::

::: footer
(Artwork by [Kanishk Srivastava](https://medium.com/@kaaanishk/illustrated-introduction-to-linear-algebra-using-numpy-11d503d244a1))
:::

::: {.notes}
- R characteristics.
- Example: `Date`. Structure: number of days since the [Unix-Epoch](https://en.wikipedia.org/wiki/Unix_time) (1970-01-01)). Method examples: ``` `+`.Date() ``` (`hms` example),  `print.Date()`.
- An object is a unit of data that has a specific **structure** and behavior (**methods**)
- An function is a predefined program unit that performs a specific task, usually taking inputs (arguments) and returning an output (result).

(TMI)

- "Following this paradigm, a software system is viewed as a collection of units, called **objects**, each of which is capable of performing the actions that are immediately related to itself as well as requesting actions of other objects." [@brookshear2020, p. 329].
- "Under this paradigm a program is constructed by connecting smaller predefined program units (predefined functions) so that each unitâ€™s outputs are used as another unitâ€™s inputs in such a way that the desired overall input-to-output relationship is obtained." [@brookshear2020, p. 327].
- `lobstr::obj_addr()` shows the memory address of an object.
:::

## Vectorized Operations {.smaller}

::::: {.columns}
:::: {.column style="width: 50%;"}
In R, most operations are **vectorized**, meaning they operate on all elements of a vector at once, without needing explicit loops.

This makes code more concise, readable, and less error-prone, while improving efficiency compared to non-vectorized languages.

::: {style="padding-top: 15px;"}
```{r}
c(1, 2, 3) + 1
```

```{r}
c(1, 2, 3) * c(1, 2, 3)
```
:::
::::
:::: {.column style="width: 50%;"}
![](images/srivastava-2019-figure-2-adapted-rgb-72-dpi.gif){fig-align="center" style="width: 60%; padding-top: 150px;"}
::::
:::::

::: footer
(Artwork by [Kanishk Srivastava](https://medium.com/@kaaanishk/illustrated-introduction-to-linear-algebra-using-numpy-11d503d244a1))
:::

::: {.notes}
- Another characteristic of R.
- Explain what the `[1]` means in object printing in the console.
:::

## Primary Data Types {.smaller}

::::: {.columns}
:::: {.column style="width: 50%;"}
These are part of the [**atomic**](https://adv-r.hadley.nz/vectors-chap.html?q=atomic#atomic-vectors) data types in R.

- `logical`: TRUE/FALSE
- `integer`: 1, 2, 3
- `double`: 1.0, 2.0, 3.0
- `character`: "Hello, World!"

::: {style="padding-top: 15px;"}
```{r}
c(1, 2, 3) |> is.atomic()
```

```{r}
as.Date("2025-01-01") |> class()
```

```{r}
as.Date("2025-01-01") |> typeof()
```
:::
::::
:::: {.column style="width: 50%;"}
![](images/primary-objects-rgb-96-dpi.png){fig-align="center" style="width: 80%; padding-top: 50px;"}
::::
:::::

::: {.notes}
- Also called the ["classic" 4 data types](https://youtu.be/e1zJS31tr88?si=7-TamPi2tmwprCUL&t=900).
- `logical` is also called `boolean` in other languages.
- `double` is also called `float` in other languages.
- `double` stands for "double-precision floating point" (`float64` ).
- 64-bit double-precision ([IEEE 754](https://en.wikipedia.org/wiki/IEEE_754)). Approximately 15â€“17 significant decimal digits of precision. There are packages that provide higher precision in R (e.g., [`Rmpfr`](https://cran.r-project.org/web/packages/Rmpfr/index.html) for arbitrary-precision arithmetic).
- `numeric` is synonymous with `double`.
- An object can also hold attributes (e.g., `class`, `names`, `dim`, etc.).
:::

## Data Classes {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- `logical()` (e.g., TRUE, FALSE)
- `integer()` (e.g., 1, 2, 3)
- `double()` (e.g., 1.0, 2.0, 3.0)
- `character()` (e.g., "Maria", "John")
- `factor()` `<br>`{=html}(e.g., 1 = "Male", 2 = "Female")
- `complex()` (e.g., 1+2i, 3+4i)
- `raw()` (e.g., 01, 0f, 10)
- `ts()` (e.g., time series data)
:::
::: {.column style="width: 50%;"}
- `Date()` (e.g., 2023-01-01) ([linear time](https://danielvartan.github.io/lubritime/reference/cycle_time.html#linear-versus-circular-time))
- `POSIXct()` (e.g., 2023-01-01 00:00:00) ([linear time](https://danielvartan.github.io/lubritime/reference/cycle_time.html#linear-versus-circular-time))
- `Interval()` (e.g., 2023-01-01 00:00:00--2023-12-15 15:40:00) ([linear time](https://danielvartan.github.io/lubritime/reference/cycle_time.html#linear-versus-circular-time))
- `Duration()` (e.g., 2 months, 3 days)`<br>`{=html}([linear time](https://danielvartan.github.io/lubritime/reference/cycle_time.html#linear-versus-circular-time))
- `Period()` (e.g., 1 year, 2 months, 3 days) (linear([ish](https://lubridate.tidyverse.org/reference/period.html#details)) time)
- `hms()` (e.g., 01:30:00) ([circular time](https://danielvartan.github.io/lubritime/reference/cycle_time.html#linear-versus-circular-time))
:::
::::

And much more...

::: {.notes}
:::

## Non-Atomic Objects {.smaller}

::::: {.columns}
:::: {.column style="width: 50%;"}
Non-atomic types are objects that can be composed of different data types.

They can also be *recursive objects*, meaning they can contain themselves as elements.

::: {style="padding-top: 0px;"}
- `list()`
- `data.frame` (a special case of `list()`)
:::

```{r}
is.atomic(list())
```

```{r}
is.recursive(list())
```
::::
:::: {.column style="width: 50%;"}
```{r}
c("a", "b", "c", c("d", "e"))
```

```{r}
c(1L, 2L, 3L, c(4L, 5L))
```

```{r}
c(1.123, 2.123, 3.123, c(4.123, 5.123))
```

```{r}
c(TRUE, FALSE, TRUE, c(FALSE, TRUE))
```

```{r}
list(list(TRUE, 1L, pi, "a"))
```
::::
:::::

::: {.notes}
- **15-minute break** after this slide.
:::

## Operations {.smaller}

::: {style="font-size: 1.5em; text-align: center; padding-top: 175px;"}
[**Left Hand Side**]{.brand-blue} `Operator` [**Right Hand Side**]{.brand-blue}
:::

::: {.notes}
- In each slide, ask students to replicate the examples in their R console.
:::

## Arithmetic Operators {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- ``` `+`() ``` Addition
- ``` `-`() ``` Subtraction
- ``` `*`() ``` Multiplication
- ``` `/`() ``` Division
- ``` `^`() ``` Exponentiation
- ``` `%/%`() ``` Integer division`<br>`{=html}(only the integer part)
- ``` `%%`() ``` Modulus`<br>`{=html}(remainder from division)
:::
::: {.column style="width: 50%;"}
```{r}
1 + 1
```

```{r}
1 - 1
```

```{r}
1 * 2
```

```{r}
1 / 2
```

```{r}
2^2
```

```{r}
5 %/% 2
```

```{r}
5 %% 2
```
:::
::::

::: {.notes}
:::

## Assignment Operators {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- ``` `<-`() ``` Leftwards assignment`<br>`{=html}(**use this!**)
- ``` `<<-`() ``` Leftwards assignment (Global Environment)
- ``` `->`() ``` Rightwards assignment
- ``` `->>`() ``` Rightwards assignment (Global Environment)
- ``` `=`() ``` Equals sign assignment
:::
::: {.column style="width: 50%;"}
```{r}
x <- 1
x
```

```{r}
x <<- 1
x
```

```{r}
1 -> x
x
```

```{r}
1 ->> x
x
```

```{r}
x = 1
x
```

```r
1 = x # Error!
```
:::
::::

::: {.notes}
:::

## Names {.smaller}

![](images/allison-horst-figure-46.png){.nostretch fig-align="center" style="height: 550px;"}

::: footer
(Artwork by [Allison Horst](https://allisonhorst.com/horst-hill-collaborations))
:::

::: {notes}
- Bryan, J. et al. [How to name files](https://rstats.wtf/naming-files).
- Wickham, H. [File](https://style.tidyverse.org/files.html).
:::

## Names {.smaller}

:::: {.columns}
::: {.column style="width: 47.5%;"}
R has strict rules regarding the names of objects.

- Names can only contain letters, numbers, periods (`.`), and underscores (`_`).
- Names can't start with a number or an underscore.
- Names can't start with a period and be followed by a number.
- Names are case-sensitive.
- Names can't be reserved words.
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%;"}
`variable-name` [Bad]{.bold-black} (kebab-case)

`variable.name` [Good]{.bold-black}, but not advisable

`variable_name` [Good]{.bold-black} (snake_case), most used in R

`1variable_name` [Bad]{.bold-black}

`_variable_name` [Bad]{.bold-black}

`.1variable_name` [Bad]{.bold-black}

`variableName` [Good]{.bold-black} (camelCase)

`VariableName` [Good]{.bold-black} (PascalCase)
:::
::::

::: {.notes}
- `variable` and `Variable` are different.
- Reserved words examples: `if`, `else`, `TRUE`, `FALSE`.
:::

## Comparison Operators {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- ``` `==`() ``` Equal to
- ``` `!=`() ``` Not equal to
- ``` `>`() ``` Greater than
- ``` `<`() ``` Less than
- ``` `>=`() ``` Greater than or equal to
- ``` `<=`() ``` Less than or equal to
:::
::: {.column style="width: 50%;"}
```{r}
1 == 1
```

```{r}
1 != 1
```

```{r}
2 > 1
```

```{r}
2 < 1
```

```{r}
1 >= 1
```

```{r}
2 <= 1
```
:::
::::

::: {.notes}
:::

## Logical Operators {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- ``` `&`() ``` AND (Element-wise)
- ``` `&&`() ``` AND
- ``` `|`() ``` OR (Element-wise)
- ``` `||`() ``` OR
- ``` `!`() ``` NOT
:::
::: {.column style="width: 50%;"}
```{r}
c(TRUE, FALSE) & c(TRUE, TRUE)
```

```{r}
TRUE && FALSE
```

```r
c(TRUE, FALSE) && c(TRUE, TRUE) # Error!
```

```{r}
c(TRUE, FALSE) | c(TRUE, TRUE)
```

```{r}
TRUE || FALSE
```

```r
c(TRUE, FALSE) || c(TRUE, TRUE) # Error!
```

```{r}
!TRUE
```
:::
::::

::: {.notes}
:::

## Other Operators {.smaller}

:::: {.columns}
::: {.column style="width: 50%;"}
- ``` `:`() ``` Sequence operator
- ``` `%in%`() ``` Matching operator
- ``` `%*%`() ``` Matrix multiplication

![](images/hartnett-2021-figure-2.svg){fig-align="center" style="width: 80%; padding-top: 0px;"}
:::
::: {.column style="width: 50%;"}
```{r}
1:10
```

```{r}
x <- -5
y <- 0

x:y # Bad! Use `seq()` instead.
```

```{r}
"a" %in% c("a", "b", "c")
```

```{r}
x <- matrix(1:4, nrow = 2, ncol = 2, byrow = TRUE)
y <- matrix(5:8, nrow = 2, ncol = 2, byrow = TRUE)

x %*% y
```
:::
::::

::: footer
(Reproduced from @hartnett2021)
:::

::: {.notes}
:::

## Operator Precedence {.smaller}

:::: {.columns}
::: {.column style="width: 47.5%; font-size: 0.9em;"}
(@) ``` `^`() ``` Exponent (Right to Left)
(@) ``` -x ```, ``` +x ``` Unary minus, Unary plus`<br>`{=html}(Left to Right)
(@) ``` `%%`() ``` Modulus (Left to Right)
(@) ``` `*`() ```, ``` `/`() ``` Multiplication, Division`<br>`{=html}(Left to Right)
(@) ``` `+`() ```, ``` `-`() ``` Addition, Subtraction`<br>`{=html}(Left to Right)
(@) ``` `==`() ```, ``` `!=`() ``` Comparisons`<br>`{=html}(Left to Right)
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%; font-size: 0.9em;"}
(@) ``` `!`() ``` Logical NOT (Left to Right)
(@) ``` `&`() ```, ``` `&&`() ``` Logical AND (Left to Right)
(@) ``` `|`() ```, ``` `||`() ``` Logical OR (Left to Right)
(@) ``` `->`() ```, ``` `->>`() ``` Rightward assignment`<br>`{=html}(Left to Right)
(@) ``` `<-`() ```, ``` `<<-`() ``` Leftward assignment`<br>`{=html}(Right to Left)
(@) ``` `=`() ```: Leftward assignment`<br>`{=html}(Right to Left)
:::
::::

:::: {.columns}
::: {.column style="width: 47.5%; font-size: 0.9em;"}
```{r}
2^2 + 1 * 2
```
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%; font-size: 0.9em;"}
```{r}
!FALSE && TRUE
```
:::
::::

::: {.notes}
:::

## Subsetting {.smaller}

::::: {.columns}
:::: {.column style="width: 47.5%;"}
**Atomic**

- ``` `[`() ``` 1 level extraction

```{r}
c("a", "b", "c")[1]
```

::: {style="padding-top: 15px;"}
**Indexation**

Indexation starts at `1` in R!

```{r}
c("a", "b", "c")[0]
```

```{r}
c("a", "b", "c")[1]
```

```{r}
c("a", "b", "c")[2]
```

```{r}
c("a", "b", "c")[3]
```
:::
::::
:::: {.column style="width: 5%;"}
::::
:::: {.column style="width: 47.5%;"}
**Non-Atomic**

- ``` `[`() ``` 1 level extraction
- ``` `[[`() ``` 2 level extraction
- ``` `$`() ``` 2 level extraction

```{r}
data <- list(a = 1, b = list(2, 3))
```

```{r}
data[1]
```

```{r}
data[[1]]
```

```{r}
data$a # == data[["a"]]
```

```{r}
data[["b"]][[2]]
```
::::
:::::

::: {.notes}
:::

## Subsetting {.smaller}

:::: {.columns}
::: {.column style="width: 47.5%;"}
**Data Frames**

- `x[i, ]` Extract line `i`
- `x[, j]` Extract column/variable `j`
- `x[i, j]` Extract line `i` from column/variable `j`
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%;"}
```{r}
data <- data.frame(a = c(1, 2), b = c(4, 5))

data
```

```{r}
data["a"]
```

```{r}
data[["a"]] # == data$a
```

```{r}
data[1, ]
```

```{r}
data[, 1]
```

```{r}
data[1, 1]
```
:::
::::

::: {.notes}
:::

## Special Values {.smaller}

::::: {.columns}
:::: {.column style="width: 47.5%;"}
`NA` (*Not Available*)

Missing values must be explicitly declared in R. For that R uses the `NA` value.

`NA` comes in different flavors, for example: `NA_integer_`, `NA_real_`, `NA_character_`, `NA_complex_`.

If you use just `NA`, R will use the most appropriate type.

```{r}
c(1, NA, 3)
```

```{r}
is.na(c(1, NA, 3))
```
::::
:::: {.column style="width: 5%;"}
::::
:::: {.column style="width: 47.5%;"}
`NaN` (*Not a Number*)

```{r}
0 / 0
```

```{r}
is.nan(0 / 0)
```

::: {style="padding-top: 15px;"}
`Inf` (*Infinite*)

```{r}
1 / 0
```

```{r}
-1 / 0
```

```{r}
is.infinite(1 / 0)
```
:::

::: {style="padding-top: 30px;"}
**Tip**: See the [`naniar`](https://naniar.njtierney.com/) package.
:::
::::
:::::

::: {.notes}
- **15-minute break** after this slide.
:::

## Pipes {.smaller}

::::: {.columns}
:::: {.column style="width: 47.5%;"}
**R Native Pipe**<br>
[(Introduced in [R 4.1.0](https://cran.r-project.org/bin/windows/base/old/4.1.0/NEWS.R-4.1.0.html))]{style="font-size: 0.7em"}

::: {style="padding-top: 10px; padding-bottom: 15px;"}
```r
object |> function()
object |> function(1, par = _)
```
:::

```{r}
pi |>
  round() |>
  rep("pi", times = _)
```
::::
:::: {.column style="width: 5%;"}
::::
:::: {.column style="width: 47.5%;"}
**[`magrittr`](https://magrittr.tidyverse.org/) Pipe**

::: {style="padding-top: 15px;  padding-bottom: 15px;"}
```r
object %>% function()
object %>% function(1, par = .)
object %>% function(1, .)
```
:::

```{r}
library(magrittr)
```

```{r}
pi %>%
  round() %>%
  rep("pi", times = .)
```
::::
:::::

::: {style="padding-top: 15px;"}
Click [here](https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe/) to learn the differences between the base R and `magrittr` pipes.
:::

::: {.notes}
:::

## Control Flow: Choices {.smaller}

```r
if (condition) true_action
if (condition) true_action else false_action
```

:::: {.columns}
::: {.column style="width: 47.5%; padding-top: 15px;"}
```{r}
x <- 60

if (x > 90) {
    "A"
  } else if (x > 80) {
    "B"
  } else if (x > 50 && x < 100) {
    "C"
  } else if (x > 1) {
    "D"
  } else {
    "E"
  }
```
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%;"}
**is.\* Functions**

- `is.logical()`
- `is.integer()`
- `is.numeric()`
- `is.character()`

```{r}
x <- "a"

if (is.numeric(x)) {
    "A"
  } else {
    "B"
  }
```
:::
::::

::: {.notes}
:::

## Exercise {.smaller}

::: {.notes}
:::

## Control Flow: Loops {.smaller}

ðŸš¨ **Avoid loops** ðŸš¨ (if you can).

Especially when dealing with large datasets. Use  **functionals** instead.

:::: {.columns}
::: {.column style="width: 47.5%; padding-top: 15px;"}
```r
while (condition) perform_action
```

```{r}
x <- 0

while (x < 5) {
  x <- x + 1
  print(x)
}
```
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%; padding-top: 15px;"}
```r
for (item in vector) perform_action
```

```{r}
for (i in 1:5) {
  print(i)
}
```
:::
::::

::: {.notes}
:::

## Exercise {.smaller}

::: {.notes}
:::

## Functions {.smaller}

```r
name <- function(parameter_1, parameter_2, ...) expression
```

::::: {.columns}
:::: {.column style="width: 47.5%; padding-top: 10px;"}
The last evaluated expression is the return value of the function.

You can use `return()` to return a value before the end of the function, but this is a bad practice.

```{r}
foo <- function(x) {
  x + 1
}

foo(9)
```
::::
:::: {.column style="width: 5%; padding-top: 0px;"}
::::
:::: {.column style="width: 47.5%; padding-top: 30px;"}
```{r}
foo <- function(x) {
  return(x + 1)

  "a"
}

foo(9)
```

::: {style="padding-top: 15px;"}
**Shorthand Notation**<br>
[(Introduced in [R 4.1.0](https://cran.r-project.org/bin/windows/base/old/4.1.0/NEWS.R-4.1.0.html))]{style="font-size: 0.7em"}

```{r}
foo <- function(x) x(9)

foo(\(x) x + 1)
```
:::
::::
:::::

::: {.notes}
:::

## Exercise {.smaller}

::: {.notes}
- **15-minute break** after this slide.
:::

## Functionals {.smaller}

:::: {.columns}
::: {.column style="width: 47.5%; font-size: 0.95em;"}
A **functional** is a function that takes a function as an input and returns a vector as output [@wickham2019].

It makes the work of the programmer easier, because it allows to apply a function to a vector without the need of a loop. Because these functions are usually written in C (a lower-level programming language), they are very fast.

R have native functionals (e.g., `lapply()`), but prefer solutions from the [`purrr`](https://purrr.tidyverse.org/) package.
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%;"}
```{r}
triple <- function(x) x * 3
```

```{r}
with_for_loop <- function(x) {
  out <- numeric()
  for (i in x) out <- c(out, triple(i))
  out
}
```

```{r}
library(purrr)

with_map <- function(x) map_dbl(x, triple)
```

```{r}
library(microbenchmark)

microbenchmark(
  with_for_loop(1:1000),
  with_map(1:1000),
  times = 100,
  check = "equal"
)
```
:::
::::

::: {.notes}
- Exercise.
- **15-minute break** after this slide.
:::

## Exercise {.smaller}

::: {.notes}
:::

## Environments {.smaller}

[Scoping](https://adv-r.hadley.nz/functions.html?q=scoping#lexical-scoping):  The act of finding the value associated with a name.

:::: {.columns}
::: {.column style="width: 47.5%; padding-top: 15px;"}
```{r}
x <- 10

foo <- function() {
  x <- 20

  x
}

foo()
```
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%; padding-top: 15px;"}
```{r}
foo <- function() {
  x <<- 50

  invisible()
}

foo()
x
```
:::
::::

::: {.notes}
:::

## Packages {.smaller}

::::: {.columns}
:::: {.column style="width: 47.5%;"}
[**The Unix philosophy**](https://en.wikipedia.org/wiki/Unix_philosophy)

Each program must do one thing well [@mcilroy1978].

In R, the fundamental unit of shareable code is the package.

A package bundles together code, data, documentation, and tests, and is easy to share with others [@wickham2023d].
::::
:::: {.column style="width: 5%;"}
::::
:::: {.column style="width: 47.5%;"}
```r
install.packages("package_name")
```

::: {style="padding-top: 15px;"}
```r
library("package_name")
```

```{r}
library(hms)
library(lubridate)
library(mctq)
```

```{r}
so(parse_hm("23:00"), dhours(2))
```
:::

::: {style="padding-top: 15px;"}
```r
package_name::function_name()
```

```{r}
hms::parse_hm("23:00")
```
:::
::::
:::::

::: {style="padding-top: 15px;"}
**Note**: Other programming languages refer to packages as *libraries*.
:::

::: {.notes}
:::

## Packages {.smaller}

**R is just the core**. It needs packages to do anything useful.

A typical installation of R comes with a [set](https://cran.r-project.org/manuals.html#:~:text=recommended%20packages) of packages, like:

- `base`: Basic R functions (e.g., `sum()`)
- `datasets`: Some datasets for testing and teaching (e.g., `mtcars`)
- `graphics`: The basic graphics functions (e.g., `plot()`)
- `grDevices`: The graphics devices (e.g., `pdf()`)
- `methods`: The built-in object-oriented programming system
- `parallel`: Support for parallel computation
- `stats`: Basic statistical functions (e.g., `t.test()`)
- `utils`: Utility functions (e.g., `install.packages()`)

## Other Kind of Objects {.smaller}

::::: {.columns}
:::: {.column style="width: 47.5%; font-size: 0.85em;"}
Based on the atomic types, we can create other types of objects.

**Using the right kind of object in R is very important**, because these objects also include methods to deal with particular types of data.

For example, time can be expressed in different ways, like linear time (e.g., durations, periods, data-time, intervals) and circular time (e.g., time of day). We can also have time series, which are a sequence of data points taken at successive points in time.
::::
:::: {.column style="width: 5%;"}
::::
:::: {.column style="width: 47.5%; font-size: 0.9em;"}
`Date`<br>(Days since 1970-01-01 ([UNIX epoch](https://en.wikipedia.org/wiki/Unix_time)))

```{r}
as.Date("1970-01-01") |> as.numeric()
```

```{r}
as.Date("1970-01-01") + 1
```

::: {style="padding-top: 15px;"}
`POSIXct`<br>(Seconds since 1970-01-01 ([UNIX epoch](https://en.wikipedia.org/wiki/Unix_time)))
```{r}
as.POSIXct("1970-01-01 00:00:00", tz = "UTC") |>
  as.numeric()
```

```{r}
as.POSIXct("1970-01-01 00:00:00", tz = "UTC") + 1
```
:::
::::
:::::

::: {.notes}
:::

## Commenting {.smaller}

ðŸš¨ **Only if necessary** ðŸš¨

Your code must speak for itself.

In data analysis code, **only use comments to record important things**. If you need comments to explain what your code is doing, consider rewriting your code to be clearer [@wickhama].

::: {style="padding-top: 15px;"}
```r
# This is a comment.

1 + 1 # This is also a comment.

# 1 + 1 # You can also comment code that you don't want to run.
```
:::

::: {.notes}
:::

## Documentation {.smaller}

One the most important things in programming is to know how to find help. In R, you can use the `help()` function to get help on a function or package.

Since R has more an academic focus, documentation is usually plentiful and very well written.

::: {style="padding-top: 10px;"}
```r
help(mean)
```

```r
?mean
```
:::

::: {style="padding-top: 15px;"}
**Documentation Websites**: The `logolink` R package [documentation](https://danielvartan.github.io/logolink/).
:::

::: {.notes}
:::

## The Tidyverse {.smaller}

[![](images/tidyverse-hex-logo.png){style="width: 120px;"}](https://www.tidyverse.org/)

[Tidyverse](https://www.tidyverse.org/) is a collection of R packages designed for data science. All packages share an underlying design philosophy ([The Tidy Manifesto](https://tidyverse.tidyverse.org/articles/manifesto.html)), grammar, and data structures.

It was created by [Hadley Wickham](https://hadley.nz/), a prominent figure in the R community and author of several key references for this course. Hadley Wickham's contributions have significantly shaped modern R programming.

::: {.notes}
:::

## Main Tidyverse Packages {.smaller}

The [Tidyverse](https://tidyverse.org/) also has a meta-package that installs or load the most important packages from the collection.

:::: {.columns}
::: {.column style="width: 50%; padding-top: 10px; padding-bottom: 10px;"}
```r
install.packages("tidyverse")
```
:::
::: {.column style="width: 50%; padding-top: 10px; padding-bottom: 10px;"}
```r
library("tidyverse")
```
:::
::::

- [`readr`](https://readr.tidyverse.org/): Read flat files (`csv`, `tsv`, `fwf`) into R.
- [`stringr`](https://stringr.tidyverse.org/): A fresh approach to string manipulation in R.
- [`lubridate`](https://lubridate.tidyverse.org/): Make working with dates in R just that little bit easier.
- [`dplyr`](https://dplyr.tidyverse.org/): A grammar of data manipulation.
- [`purrr`](https://purrr.tidyverse.org/): A functional programming toolkit for R.
- [`forcats`](https://forcats.tidyverse.org/): Tools for working with categorical variables (factors).
- [`ggplot2`](https://ggplot2.tidyverse.org/): An implementation of the Grammar of Graphics in R.

::: {.notes}
- Present an overview of each package.
:::

## The rOpenSci {.smaller}

[![](images/ropensci-hex-logo.png){style="width: 150px;"}](https://ropensci.org/)

[rOpenSci](https://ropensci.org/) is a non-profit initiative founded in 2011 that brings together a community of researchers and developers committed to open science. They create and maintain high-quality R packages that provide access to data and tools from diverse sources, ensuring reliability and reproducibility in scientific research.

All packages go through a **peer-review** process, which ensures that they are well written and reliable.

**Example**: [`mctq`](https://github.com/ropensci/mctq) R package peer-review.

::: {.notes}
:::

## Base R Solutions {.smaller}

You can do most of the things you need with the packages that come bundled with R. However, that is not the most efficient way to do things today.

In this course **we are going to focus on the Tidyverse and rOpenSci packages**, which are the most modern and efficient way to work with data in R.

If you want a deeper understanding of the R language, we encourage you to explore the base R solutions.

::: {.notes}
:::

## Best Practices {.smaller}

You can learn a lot about a person just by looking at their code ðŸ‘€.

:::: {.columns}
::: {.column style="width: 47.5%; font-size: 0.9em;"}
[**Tidyverse Style Guide**](https://style.tidyverse.org/)

> Variable and function names should use only lowercase letters, numbers, and `_`. Use underscores (`_`) (so called snake case) to separate words within a name.

```r
# Good
day_one
day_1

# Bad
DayOne
dayone
```
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%; font-size: 0.9em;"}
[**Tidy Design Principles**](https://design.tidyverse.org/)

The tidyverse has four guiding principles:

- It is **human centered**.
- It is **consistent**.
- It is **composable**.
- It is **inclusive**.
:::
::::

::: {.notes}
:::

## How to Learn More {.smaller}

:::: {.columns}
::: {.column style="width: 47.5%;"}
[![](images/wickham-2023-book-cover.png){fig-align="center" style="width: 85%; padding-top: 0px;"}](https://r4ds.hadley.nz//)
:::
::: {.column style="width: 5%;"}
:::
::: {.column style="width: 47.5%;"}
[![](images/wickham-2019-book-cover.png){fig-align="center" style="width: 75%;"}](https://adv-r.hadley.nz/)
:::
::::

::: footer
(Book cover image from @wickham2023e and @wickham2019)
:::

::: {.notes}
- **15-minute break** or **day end** after this slide.
:::
